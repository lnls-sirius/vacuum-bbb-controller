# VBC-TURBOVAC.db

# Record definition for controlling valves (through BBB pins).
# parameters:
# PORT: Name of the serial port configured in asynDriver.
# SCAN_RATE: Record scan rate (time interval between two consecutive messages).

#==============================================================================
# Header: CONTROL (STX, LGE, ADR)
#==============================================================================
record(bo, "$(PREFIX):OnOff") {
    field(DESC, "Turns pump On/Off")
    field(OUT, "@VBC-TURBOVAC.proto task_telegram $(PORT)")
    field(DTYP, "stream")
    field(SCAN, "$(SCAN_RATE)")
    field(ZNAM, "Off")                          # Zero Name
    field(ONAM, "On")                           # One Name
}
#==============================================================================
# Header: CONTROL (STX, LGE, ADR)
#==============================================================================
record (ao, "$(PREFIX):STX-SP") {
    field(DESC, "STX: Start byte")
    field(VAL, "2")
    field(DTYP, "stream")
    field(OUT, "@VBC-TURBOVAC.proto task_telegram $(PORT)")
    field(SCAN, "Passive")
}
record (ao, "$(PREFIX):LGE-SP") {
    field(DESC, "LGE: Length of the payload")
    field(VAL, "22")
    field(DTYP, "stream")
    field(OUT, "@VBC-TURBOVAC.proto task_telegram $(PORT)")
    field(SCAN, "Passive")
}
record (ao, "$(PREFIX):ADR-SP") {
    field(DESC, "ADR: Frequency converter address")
    field(VAL, "0")
    field(DTYP, "stream")
    field(OUT, "@VBC-TURBOVAC.proto task_telegram $(PORT)")
    field(SCAN, "Passive")
}
#==============================================================================
# Header: STATUS (STX, LGE, ADR)
#==============================================================================
record (ai, "$(PREFIX):STX-RB") {
    field(DESC, "STX: Start byte")
    field(DTYP, "stream")
    field(INP, "@VBC-TURBOVAC.proto STX $(PORT)")
    field(SCAN, "I/O Intr")
}
record (ai, "$(PREFIX):LGE-RB") {
    field(DESC, "LGE: Length of the payload")
    field(DTYP, "stream")
    field(INP, "@VBC-TURBOVAC.proto LGE $(PORT)")
    field(SCAN, "I/O Intr")
}
record (ai, "$(PREFIX):ADR-RB") {
    field(DESC, "ADR: Frequency converter address")
    field(DTYP, "stream")
    field(INP, "@VBC-TURBOVAC.proto ADR $(PORT)")
    field(SCAN, "I/O Intr")
}
#==============================================================================
# PKW area: CONTROL (PKE, AK, IND)
#==============================================================================
record (ao, "$(PREFIX):PNU-SP") {
    field(DESC, "PNU: Parameter number")
    field(VAL, "1")
    field(DTYP, "stream")
    field(OUT, "@VBC-TURBOVAC.proto task_telegram $(PORT)")
    field(SCAN, "Passive")
}
record (ao, "$(PREFIX):AK-SP") {
    field(DESC, "AK: Type of parameter access")
    field(VAL, "1")
    field(DTYP, "stream")
    field(OUT, "@VBC-TURBOVAC.proto task_telegram $(PORT)")
    field(SCAN, "Passive")
}
record (ao, "$(PREFIX):IND-SP") {
    field(DESC, "IND: Parameter index")
    field(VAL, "0")
    field(DTYP, "stream")
    field(OUT, "@VBC-TURBOVAC.proto task_telegram $(PORT)")
    field(SCAN, "Passive")
}
record (ao, "$(PREFIX):PWE-SP") {
    field(DESC, "PWE: Parameter value")
    field(VAL, "0")
    field(DTYP, "stream")
    field(OUT, "@VBC-TURBOVAC.proto task_telegram $(PORT)")
    field(SCAN, "Passive")
}
#==============================================================================
# PKW area: STATUS (PKE, AK, IND)
#==============================================================================
record (ai, "$(PREFIX):PNU-RB") {
    field(DESC, "PNU: Parameter number")
    field(DTYP, "stream")
    field(INP, "@VBC-TURBOVAC.proto PNU $(PORT)")
    field(SCAN, "I/O Intr")
}
record (ai, "$(PREFIX):AK-RB") {
    field(DESC, "AK: Type of parameter access")
    field(DTYP, "stream")
    field(INP, "@VBC-TURBOVAC.proto AK $(PORT)")
    field(SCAN, "I/O Intr")
}
record (ai, "$(PREFIX):IND-RB") {
    field(DESC, "IND: Parameter index")
    field(DTYP, "stream")
    field(INP, "@VBC-TURBOVAC.proto IND $(PORT)")
    field(SCAN, "I/O Intr")
}
record (ai, "$(PREFIX):PWE-RB") {
    field(DESC, "PWE: Parameter value")
    field(DTYP, "stream")
    field(INP, "@VBC-TURBOVAC.proto PWE $(PORT)")
    field(SCAN, "I/O Intr")
}
#==============================================================================
# PZD area: CONTROL (PZD1)
#==============================================================================
record (mbbo, "$(PREFIX):PZD1-SP") {
    field(DESC, "PZD1: USS Control Word")
    # bit 0: Start/Stop
    # bit 1: Not assigned
    # bit 2: Not assigned
    # bit 3: Not assigned
    # bit 4: Not assigned
    # bit 5: 24 VDC output X201
    # bit 6: Enable main setpoint PZD2
    # bit 7: Reset error
    #field(ZRVL, "")
    field(DTYP, "stream")
    field(OUT, "@VBC-TURBOVAC.proto task_telegram $(PORT)")
    field(SCAN, "Passive")
}
#==============================================================================
# PZD area: STATUS (PZD1)
#==============================================================================
record (ai, "$(PREFIX):PZD1-RB0") {
    field(DESC, "PZD1: USS Status Byte (LSB)")
    # bit 0: Ready for operation
    # bit 1: No function
    # bit 2: Operation enabled
    # bit 3: Error condition (all components)
    # bit 4: Accelerating
    # bit 5: Decelerating
    # bit 6: Switch-on lock
    # bit 7: Temperature warning
    field(DTYP, "stream")
    field(INP, "@VBC-TURBOVAC.proto PZD1_0 $(PORT)")
    field(SCAN, "I/O Intr")
}
record (ai, "$(PREFIX):PZD1-RB1") {
    field(DESC, "PZD1: USS Status Byte (MSB)")
    # bit  8: No function
    # bit  9: Parameter channel enabled
    # bit 10: Normal operation detained
    # bit 11: Pump is turning
    # bit 12: No function
    # bit 13: Overload warning
    # bit 14: Collective warning
    # bit 15: Process channel enabled
    field(DTYP, "stream")
    field(INP, "@VBC-TURBOVAC.proto PZD1_1 $(PORT)")
    field(SCAN, "I/O Intr")
}
#==============================================================================
# PZD area: CONTROL (PZD2, PZD3, PZD4, PZD6)
#==============================================================================
record (ao, "$(PREFIX):PZD2-SP") {
    field(DESC, "PZD2: Set pump frequency")
    field(VAL, "1200")
    field(EGU, "Hz")
    field(DTYP, "stream")
    field(OUT, "@VBC-TURBOVAC.proto task_telegram $(PORT)")
    field(SCAN, "Passive")
}
record (ao, "$(PREFIX):PZD3-SP") {
    field(DESC, "PZD3: Frequency converter temperature")
    field(EGU, "deg. C")
    field(DTYP, "stream")
    field(OUT, "@VBC-TURBOVAC.proto task_telegram $(PORT)")
    field(SCAN, "Passive")
}
record (ao, "$(PREFIX):PZD4-SP") {
    field(DESC, "PZD4: Current motor current")
    field(EGU, "A")
    field(DTYP, "stream")
    field(OUT, "@VBC-TURBOVAC.proto task_telegram $(PORT)")
    field(SCAN, "Passive")
}
record (ao, "$(PREFIX):PZD6-SP") {
    field(DESC, "PZD6: intermediate circuit voltage")
    field(EGU, "V")
    field(DTYP, "stream")
    field(OUT, "@VBC-TURBOVAC.proto task_telegram $(PORT)")
    field(SCAN, "Passive")
}
#==============================================================================
# PZD area: STATUS (PZD2, PZD3, PZD4, PZD6)
#==============================================================================
record (ai, "$(PREFIX):PZD2-RB") {
    field(DESC, "PZD2: Current stator frequency")
    field(EGU, "Hz")
    field(DTYP, "stream")
    field(INP, "@VBC-TURBOVAC.proto PZD2 $(PORT)")
    field(SCAN, "I/O Intr")
}
#------------------------------------------------------------------------------
record (ai, "$(PREFIX):PZD3-RB") {
    field(DESC, "PZD3: Frequency converter temperature")
    field(EGU, "deg. C")
    field(DTYP, "stream")
    field(INP, "@VBC-TURBOVAC.proto PZD3 $(PORT)")
    field(SCAN, "I/O Intr")
}
#------------------------------------------------------------------------------
record (ai, "$(PREFIX):PZD4-RB") {
    field(DESC, "PZD4: Current motor current")
    field(EGU, "A")
    field(DTYP, "stream")
    field(INP, "@VBC-TURBOVAC.proto PZD4 $(PORT)")
    field(SCAN, "I/O Intr")
    field(PREC, "1")                            # Display Precision
}
#------------------------------------------------------------------------------
record (ai, "$(PREFIX):PZD6-RB") {
    field(DESC, "PZD6: intermediate circuit voltage")
    field(EGU, "V")
    field(DTYP, "stream")
    field(INP, "@VBC-TURBOVAC.proto PZD6 $(PORT)")
    field(SCAN, "I/O Intr")
    field(PREC, "1")                            # Display Precision
}
#==============================================================================
